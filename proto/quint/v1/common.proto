syntax = "proto3";

package quint.v1;

option go_package = "github.com/Quint-Security/quint-proto/gen/go/quint/v1;quintv1";

// ── JSON-RPC base types ─────────────────────────────────────────

message JsonRpcRequest {
  string jsonrpc = 1;  // Always "2.0"
  oneof id_value {
    string id_string = 2;
    int64  id_number = 3;
  }
  bool   id_null = 4;  // True if id is explicitly null
  string method  = 5;
  bytes  params  = 6;  // JSON-encoded params
}

message JsonRpcResponse {
  string jsonrpc = 1;
  oneof id_value {
    string id_string = 2;
    int64  id_number = 3;
  }
  bool   id_null  = 4;
  bytes  result   = 5;  // JSON-encoded result
  JsonRpcError error = 6;
}

message JsonRpcError {
  int32  code    = 1;
  string message = 2;
  bytes  data    = 3;  // JSON-encoded data (optional)
}

// ── Enums shared across services ────────────────────────────────

enum Action {
  ACTION_UNSPECIFIED = 0;
  ACTION_ALLOW       = 1;
  ACTION_DENY        = 2;
}

enum Verdict {
  VERDICT_UNSPECIFIED  = 0;
  VERDICT_ALLOW        = 1;
  VERDICT_DENY         = 2;
  VERDICT_PASSTHROUGH  = 3;
}

enum Direction {
  DIRECTION_UNSPECIFIED = 0;
  DIRECTION_REQUEST     = 1;
  DIRECTION_RESPONSE    = 2;
}

enum LogLevel {
  LOG_LEVEL_UNSPECIFIED = 0;
  LOG_LEVEL_DEBUG       = 1;
  LOG_LEVEL_INFO        = 2;
  LOG_LEVEL_WARN        = 3;
  LOG_LEVEL_ERROR       = 4;
}

// ── Action Taxonomy ─────────────────────────────────────────────
// Canonical action naming: domain:scope:verb

enum ActionDomain {
  ACTION_DOMAIN_UNSPECIFIED = 0;
  ACTION_DOMAIN_MCP         = 1;
  ACTION_DOMAIN_TOOL        = 2;
  ACTION_DOMAIN_DATA        = 3;
  ACTION_DOMAIN_AUTH        = 4;
  ACTION_DOMAIN_NET         = 5;
  ACTION_DOMAIN_SYS         = 6;
  ACTION_DOMAIN_AGENT       = 7;
}

enum DataClassification {
  DATA_CLASSIFICATION_UNSPECIFIED = 0;
  DATA_CLASSIFICATION_PUBLIC       = 1;
  DATA_CLASSIFICATION_INTERNAL     = 2;
  DATA_CLASSIFICATION_PII          = 3;
  DATA_CLASSIFICATION_PII_SENSITIVE = 4;
  DATA_CLASSIFICATION_FINANCIAL    = 5;
  DATA_CLASSIFICATION_HEALTH       = 6;
  DATA_CLASSIFICATION_AUTH         = 7;
  DATA_CLASSIFICATION_LEGAL        = 8;
}

enum MCPTransport {
  MCP_TRANSPORT_UNSPECIFIED     = 0;
  MCP_TRANSPORT_STDIO           = 1;
  MCP_TRANSPORT_SSE             = 2;
  MCP_TRANSPORT_STREAMABLE_HTTP = 3;
}

// ── MCP tool call ───────────────────────────────────────────────

message McpToolCall {
  string name      = 1;
  bytes  arguments = 2;  // JSON-encoded arguments
}

// ── Signing key pair ────────────────────────────────────────────

message KeyPair {
  bytes public_key  = 1;  // SPKI DER
  bytes private_key = 2;  // PKCS8 DER
}
